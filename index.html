<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Customer Project Intake Form</title>
<style>
  @font-face {
    font-family: "Arial Nova";
    src: url("./assets/fonts/ArialNova-Regular.woff2") format("woff2");
    font-weight: 400;
    font-style: normal;
    font-display: swap;
  }
  @font-face {
    font-family: "Arial Nova";
    src: url("./assets/fonts/ArialNova-Bold.woff2") format("woff2");
    font-weight: 700;
    font-style: normal;
    font-display: swap;
  }

  :root {
    --orange: #FD6E39; /* Aggreko Orange */
    --navy: #1C2E39;   /* Aggreko Dark Blue/Grey */
    --border: #dfe3eb;
    --section-bg: #f7f8fb;
    --section-border: #e5e8f0;
    --font-regular: "Arial Nova", Arial, sans-serif;
    --font-bold: "Arial Nova", Arial, sans-serif;
  }

  body {
    margin: 0;
    font-family: var(--font-regular);
    color: #111;
    background: #fff;
  }

  main {
    max-width: 1000px;
    margin: 20px auto;
    padding: 0 14px;
  }

  .logo-row {
    display: flex;
    justify-content: flex-end;
    margin-bottom: 24pt;
  }

  .logo-row img {
    max-width: 130px;
    height: auto;
  }

  .title-block {
    margin-top: 10px;
  }

  .title {
    font-family: var(--font-bold);
    font-size: 22pt;
    margin: 0;
  }

  .subtitle {
    font-family: var(--font-bold);
    font-size: 13pt;
    margin: 0;
  }

  .note {
    font-size: 10pt;
    color: #475569;
    margin-top: 6px;
  }

  .section-bar {
    background: var(--section-bg);
    border: 1px solid var(--section-border);
    color: var(--orange);
    font-family: var(--font-bold);
    font-size: 13pt;
    padding: 10px 12px;
    border-radius: 8px;
    margin: 18px 0 10px;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 16px;
    table-layout: fixed;
  }

  thead th {
    background: var(--navy);
    color: #fff;
    padding: 12px 10px;
    font-family: var(--font-bold);
    font-size: 12pt;
    text-align: left;
  }

  tbody tr { height: 46px; }
  tbody td {
    border: 1px solid var(--border);
    padding: 10px;
    font-size: 10pt;
    background: #fff;
  }

  input[type="text"], input[type="email"], input[type="date"], select, textarea {
    width: 100%;
    padding: 8px 10px;
    border: 1px solid #cbd5e1;
    border-radius: 8px;
    font-size: 11pt;
  }

  input:focus, select:focus, textarea:focus {
    border-color: #2563eb;
    box-shadow: 0 0 0 3px rgba(37,99,235,.15);
    outline: none;
  }

  textarea {
    resize: vertical;
    min-height: 100px;
  }

  .submit-btn {
    background: var(--navy);
    color: #fff;
    border: none;
    padding: 12px 22px;
    border-radius: 8px;
    font-family: var(--font-bold);
    font-size: 12pt;
    cursor: pointer;
    margin-top: 16pt;
    margin-bottom: 20pt;
  }

  .submit-btn:hover {
    background: var(--orange);
  }

  footer p {
    font-family: "Arial Nova", Arial, sans-serif;
    font-size: 9pt;
    color: #1C2E39;
    line-height: 1.4;
  }

  footer p b {
    font-weight: 700;
  }
</style>
</head>
<body>
<main>
  <div class="logo-row">
    <img src="https://seekvectorlogo.com/wp-content/uploads/2019/05/aggreko-vector-logo.png" alt="Aggreko Logo">
  </div>

  <div class="title-block">
    <h1 class="title">Customer Project Intake Form</h1>
    <div class="subtitle">Thermal and Hybrid</div>
  </div>
  <p class="note">Note: Please complete all applicable sections. If a field does not apply to your project, and is not compulsory, please leave it blank.</p>

  <!-- Customer Details -->
  <div class="section-bar">Customer Details</div>
  <table>
    <thead><tr><th>Description</th><th>Capacity / Unit</th><th>Customer to Populate</th></tr></thead>
    <tbody>
      <tr><td>Customer company *</td><td>–</td><td><input id="customerCompany" type="text" placeholder="Enter company name"></td></tr>
      <tr><td>Primary contact name *</td><td>–</td><td><input id="contactName" type="text" placeholder="Enter contact name"></td></tr>
      <tr><td>Email *</td><td>–</td><td><input id="email" type="email" placeholder="Enter email"></td></tr>
    </tbody>
  </table>

  <!-- Project, Site & Contract -->
  <div class="section-bar">Project, Site & Contract</div>
  <table>
    <thead><tr><th>Description</th><th>Capacity / Unit</th><th>Customer to Populate</th></tr></thead>
    <tbody>
      <tr><td>Project Name</td><td>–</td><td><input id="projectName" type="text" placeholder="Enter project name"></td></tr>
      <tr><td>Project / Site Location</td><td>–</td><td><input id="siteLocation" type="text" placeholder="Enter site location"></td></tr>
      <tr><td>Contract Term *</td><td>Years</td><td><input id="contractTerm" type="text" placeholder="Enter contract term"></td></tr>
      <tr><td>Target COD Date *</td><td>DD/MM/YYYY</td><td><input id="codDate" type="date"></td></tr>
    </tbody>
  </table>

  <!-- Power & Energy -->
  <div class="section-bar">Power & Energy</div>
  <table>
    <thead><tr><th>Description</th><th>Capacity / Unit</th><th>Customer to Populate</th></tr></thead>
    <tbody>
      <tr><td>CMD (Contracted Maximum Demand) *</td><td>MW</td><td><input id="cmd" type="text" placeholder="Enter CMD value"></td></tr>
      <tr><td>Redundancy *</td><td>N+1 or N+2</td><td><select id="redundancy"><option>Select...</option><option>N+1</option><option>N+2</option><option>Other</option></select></td></tr>
      <tr><td>Fuel Type *</td><td>Type</td><td><select id="fuelType"><option>Select fuel...</option><option>Diesel</option><option>Gas</option><option>LNG</option><option>Other</option></select></td></tr>
      <tr><td>Assumed Fuel Price</td><td>$L or $/GJ</td><td><input id="fuelPrice" type="text" placeholder="Enter fuel price"></td></tr>
      <tr><td>Fuel Facility</td><td>Description / Delivered?</td><td><input id="fuelFacility" type="text" placeholder="e.g., Onsite tanks, delivered fuel"></td></tr>
      <tr>
        <td>Land Availability *</td>
        <td>Description / Delivered?</td>
        <td>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;">
            <select id="landDescription"><option>Select description...</option><option>Confirmed</option><option>In principle</option><option>Negotiation</option><option>Unknown</option></select>
            <select id="landDelivered"><option>Delivered?</option><option>Yes</option><option>No</option><option>Unknown</option></select>
          </div>
        </td>
      </tr>
      <tr><td>Maximum Temperature</td><td>°C</td><td><input id="maxTemp" type="text" placeholder="Enter max temperature"></td></tr>
      <tr>
        <td>Voltage</td>
        <td>V</td>
        <td>
          <select id="voltageV">
            <option>Select voltage...</option>
            <option>6.5kV</option>
            <option>11kV</option>
            <option>22kV</option>
            <option>33kV</option>
            <option>66kV</option>
          </select>
        </td>
      </tr>
      <tr><td>Accommodation</td><td>Scope / Responsibility</td><td><select id="accommodation"><option>Select...</option><option>Customer</option><option>Aggreko</option><option>Shared</option><option>Not required</option></select></td></tr>
    </tbody>
  </table>

  <!-- Renewables -->
  <div class="section-bar">Renewables</div>
  <table>
    <thead><tr><th>Description</th><th>Capacity / Unit</th><th>Customer to Populate</th></tr></thead>
    <tbody>
      <tr><td>Wind</td><td>Capacity (MWp)</td><td><select id="wind"><option>Select...</option><option>Optimised</option><option>Will specify</option><option>Not applicable</option></select></td></tr>
      <tr><td>Solar PV</td><td>Capacity (MWp)</td><td><select id="solar"><option>Select...</option><option>Optimised</option><option>Will specify</option><option>Not applicable</option></select></td></tr>
      <tr><td>Battery Energy Storage (BESS)</td><td>–</td><td><select id="bess"><option>Select...</option><option>Optimised</option><option>Yes</option><option>No</option><option>Considering</option></select></td></tr>
      <tr><td>Renewable Energy Fraction (REF%)</td><td>%</td><td><input id="ref" type="text" placeholder="Enter REF%"></td></tr>
    </tbody>
  </table>

  <!-- Additional Project Details -->
  <div class="section-bar">Additional Project Details</div>
  <textarea id="notes" placeholder="Any additional context, timelines, or constraints..."></textarea>

  <!-- Submit Button -->
  <button type="button" class="submit-btn" id="submitBtn">Submit Form</button>
  <div id="submit-status"></div>

  <footer>
    <p><b>Privacy & Confidentiality:</b> Information you provide will be used to assess project requirements and budgetary pricing and may be stored in Aggreko systems in accordance with Aggreko’s privacy practices. © Aggreko.</p>
  </footer>
</main>

<script>
const FLOW_URL = "https://your-power-automate-flow-url"; // Replace with actual Flow URL

document.getElementById("submitBtn").addEventListener("click", async () => {
  const btn = document.getElementById("submitBtn");
  const statusDiv = document.getElementById("submit-status");
  btn.disabled = true;
  statusDiv.textContent = "Submitting...";

  const payload = {
    customerCompany: document.getElementById("customerCompany").value,
    contactName: document.getElementById("contactName").value,
    email: document.getElementById("email").value,
    projectName: document.getElementById("projectName").value,
    siteLocation: document.getElementById("siteLocation").value,
    contractTerm: document.getElementById("contractTerm").value,
    codDate: document.getElementById("codDate").value,
    cmd: document.getElementById("cmd").value,
    redundancy: document.getElementById("redundancy").value,
    fuelType: document.getElementById("fuelType").value,
    fuelPrice: document.getElementById("fuelPrice").value,
    fuelFacility: document.getElementById("fuelFacility").value,
    landDescription: document.getElementById("landDescription").value,
    landDelivered: document.getElementById("landDelivered").value,
    maxTemp: document.getElementById("maxTemp").value,
    voltageV: document.getElementById("voltageV").value,
    accommodation: document.getElementById("accommodation").value,
    wind: document.getElementById("wind").value,
    solar: document.getElementById("solar").value,
    bess: document.getElementById("bess").value,
    ref: document.getElementById("ref").value,
    notes: document.getElementById("notes").value
  };

  try {
    const res = await fetch(FLOW_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    const textRes = await res.text();
    let data;
    try { data = JSON.parse(textRes); } catch { data = null; }

    if (!res.ok) {
      throw new Error((data && (data.message || data.error)) || textRes || `HTTP ${res.status}`);
    }

    statusDiv.textContent = (data && (data.message || "Form submitted successfully")) || "Form submitted successfully";
    statusDiv.style.color = "green";
  } catch (err) {
    statusDiv.textContent = "Submission failed: " + (err.message || String(err));
    statusDiv.style.color = "red";
  } finally {
    btn.disabled = false;
  }
});
</script>
</body>
</html>
